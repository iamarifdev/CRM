@using App.Entity.Models
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section AdditionalStyles
{
    <link href="~/vendor/toastr/toastr.min.css" rel="stylesheet" />
    <link href="~/Content/MvcGridPagination.css" rel="stylesheet" />
    <link href="~/vendor/sweetalert2/sweetalert2.min.css" rel="stylesheet" />
}

@using (Html.BeginForm("Delete", "Suppliers", FormMethod.Post, new { @style = "display:none;", @id = "deleteForm" }))
{
    @Html.Hidden("Id")
}
<div class="card">
    <h6 class="card-header bg-primary">SUPPLIERS / LIST</h6>
    <div class="card-block">
        <div class="row">
            <div class="col-md-6">
                <a href="@Url.Action("Create")" class="btn btn-info"> <span class="fa fa-plus"></span> Create New</a>
                <button class="btn btn-outline-info refreshBtn"><span class="fa fa-refresh"></span> Refresh</button>
            </div>
            <br /><br /> <br />
            <div class="col-md-12">
                @Html.Partial("_MVCGridToolbar", new MVCGridToolbarModel()
                {
                    MVCGridName = "supplierTable",
                    PageSize = true,
                    GlobalSearch = true
                })
                @Html.MVCGrid("supplierTable")
            </div>
        </div>
    </div>
</div>

@section Scripts
{
    <script src="~/MVCGridHandler.axd/script.js"></script>
    <script src="~/vendor/toastr/toastr.min.js"></script>
    <script src="~/vendor/sweetalert2/sweetalert2.min.js"></script>
    <script>
        @if (TempData["Toastr"] != null)
        {
            @Html.Raw(TempData["Toastr"])
        }

        $(".refreshBtn").click(function() {
            MVCGrid.reloadGrid('supplierTable');
        });

        $("body").on("click",".delete", function() {
            var that = $(this).attr("data-id");
            if (that !== "") {
                $("#Id").val(that);
                swal({
                    title: 'Are you want to delete this?',
                    text: "You won't be able to undo this!",
                    type: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Confirm!',
                    cancelButtonText: 'Cancel!',
                    confirmButtonClass: 'btn btn-primary btn-lg m-r-1',
                    cancelButtonClass: 'btn btn-danger btn-lg',
                    buttonsStyling: false
                })
                .then(function (isConfirm) {
                    if (isConfirm === true) {
                        $("#deleteForm").submit();
                    } else if (isConfirm === false) {
                        swal({
                            title: 'Cancelled',
                            text: 'Information not deleted!',
                            type: 'info',
                            confirmButtonClass: 'btn btn-primary btn-lg',
                            buttonsStyling: false
                        });
                    }
                });
            }
        });
    </script>
}
